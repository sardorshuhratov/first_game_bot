<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pro Basketball 60s Challenge</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --rim-color: #fb8500; }
        body { margin: 0; overflow: hidden; background: #023047; font-family: 'Segoe UI', sans-serif; touch-action: none; }
        
        #game-container { position: relative; width: 100vw; height: 100vh; background: linear-gradient(to bottom, #14213d 0%, #000 100%); }

        /* Maydon va Savat Ustuni */
        .court-floor { position: absolute; bottom: 0; width: 100%; height: 20%; background: #000; border-top: 2px solid #fff; opacity: 0.3; }
        .post { position: absolute; bottom: 0; left: 50%; width: 12px; height: 75%; background: #333; transform: translateX(-50%); z-index: 1; }
        
        /* Savat va To'r */
        .backboard-container { position: absolute; top: 15%; left: 50%; transform: translateX(-50%); z-index: 2; }
        .backboard { width: 180px; height: 130px; background: rgba(255,255,255,0.1); border: 4px solid #fff; border-radius: 4px; display: flex; justify-content: center; align-items: flex-end; padding-bottom: 20px; backdrop-filter: blur(2px); }
        .rim { width: 75px; height: 12px; border: 4px solid var(--rim-color); border-radius: 50%; position: relative; z-index: 5; }
        .net { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); width: 65px; height: 60px; background: repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(255,255,255,0.3) 5px, rgba(255,255,255,0.3) 10px), repeating-linear-gradient(-45deg, transparent, transparent 5px, rgba(255,255,255,0.3) 5px, rgba(255,255,255,0.3) 10px); border-radius: 0 0 40% 40%; border: 1px solid rgba(255,255,255,0.2); }

        /* Koptok */
        .ball { position: absolute; bottom: 80px; left: calc(50% - 35px); width: 70px; height: 70px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #ff8500, #d62828); box-shadow: inset -5px -5px 15px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.4); z-index: 100; cursor: grab; }

        /* UI Paneli */
        #ui { position: absolute; top: 20px; width: 100%; display: flex; justify-content: space-around; color: white; font-weight: 800; font-size: 22px; z-index: 1000; }
        #timer { color: #e63946; }
        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 2000; }
        button { padding: 15px 40px; font-size: 20px; border-radius: 30px; border: none; background: #fb8500; color: white; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="ui">
            <div id="timer">‚è± 60s</div>
            <div>üèÄ <span id="score">0</span></div>
        </div>

        <div id="overlay">
            <h1>BASKETBALL PRO</h1>
            <p id="final-res"></p>
            <button onclick="startGame()">BOSHLASH</button>
        </div>

        <div class="court-floor"></div>
        <div class="post"></div>

        <div class="backboard-container">
            <div class="backboard">
                <div class="rim" id="hoop">
                    <div class="net" id="net"></div>
                </div>
            </div>
        </div>

        <div class="ball" id="ball"></div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let score = 0;
        let timeLeft = 60;
        let gameActive = false;
        let timerInterval;

        const ball = document.getElementById('ball');
        const scoreEl = document.getElementById('score');
        const timerEl = document.getElementById('timer');
        const overlay = document.getElementById('overlay');
        const net = document.getElementById('net');

        function startGame() {
            score = 0;
            timeLeft = 60;
            gameActive = true;
            scoreEl.innerText = "0";
            overlay.style.display = "none";
            startTimer();
        }

        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                timerEl.innerText = `‚è± ${timeLeft}s`;
                if (timeLeft <= 0) endGame();
            }, 1000);
        }

        function endGame() {
            gameActive = false;
            clearInterval(timerInterval);
            overlay.style.display = "flex";
            document.getElementById('final-res').innerText = `O'yin tugadi! Ball: ${score}`;
            if (tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('warning');
        }

        // Otish mantiqi
        let isDragging = false, startX, startY, startTime;

        ball.addEventListener('pointerdown', (e) => {
            if (!gameActive || isDragging) return;
            isDragging = true;
            startX = e.clientX; startY = e.clientY; startTime = Date.now();
            ball.style.transition = "none";
        });

        window.addEventListener('pointerup', (e) => {
            if (!isDragging) return;
            isDragging = false;
            const duration = Date.now() - startTime;
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;

            if (dy < -50 && duration < 500) {
                const tx = dx * 2.5;
                const ty = dy * 2.2;
                launch(tx, ty);
            } else {
                reset();
            }
        });

        function launch(tx, ty) {
            ball.style.transition = "transform 0.7s cubic-bezier(0.15, 0.85, 0.35, 1)";
            ball.style.transform = `translate(${tx}px, ${ty}px) scale(0.35) rotate(${tx}deg)`;

            setTimeout(() => {
                if (Math.abs(tx) < 40 && ty < -380 && ty > -520) {
                    score++;
                    scoreEl.innerText = score;
                    net.style.transform = "translateX(-50%) scaleY(1.3)"; // To'r tebranishi
                    setTimeout(() => net.style.transform = "translateX(-50%) scaleY(1)", 200);
                    if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('heavy');
                }
                setTimeout(reset, 500);
            }, 700);
        }

        function reset() {
            ball.style.transition = "transform 0.4s ease-out";
            ball.style.transform = "translate(0,0) scale(1) rotate(0deg)";
        }
    </script>
</body>
</html>